str(train_monthly$date_block_num)
str(train_month$date_block_num)
install.packages('hts')
install.packages('zoo')
load("D:/Projects/kaggle/time_series/working_files.RData")
str(train_month)
str(train)
ts_data <-train_month%>%mutate(year=year(date), month=month(date), day=day(date))%>%group_by(year,month)%>%summarize(sum=sum(item_cnt_day))%>%ungroup%>%select(sum) %>%ts(frequency = 12,start = 2013 )
library(DataCombine)
install.packages('dataCombine')
y
install.packages('DataCombine')
library(DataCombine)
ts_data <-train_month%>%mutate(year=year(date), month=month(date), day=day(date))%>%group_by(year,month)%>%summarize(sum=sum(item_cnt_day))%>%ungroup%>%select(sum) %>%ts(frequency = 12,start = 2013 )
knitr::opts_chunk$set(echo = TRUE)
ts_data = df()
ts_data = data.table
ts_data = data.table()
library(lubridate)
install.packages('lubridate')
library(lubridate)
ts_data <-train_month%>%mutate(year=year(date), month=month(date), day=day(date))%>%group_by(year,month)%>%summarize(sum=sum(item_cnt_day))%>%ungroup%>%select(sum) %>%ts(frequency = 12,start = 2013 )
library(forecast)
library(DataCombine)
library(ggplot2) # Data visualization
library(readr) # CSV file I/O, e.g. the read_csv function
install.packages('readr')
install.packages('forecast')
install.packages("forecast")
library(forecast)
library(DataCombine)
library(ggplot2) # Data visualization
library(readr) # CSV file I/O, e.g. the read_csv function
library (data.table)
library(lubridate)
library(dplyr)
library(tseries)
ts_data <-train_month%>%mutate(year=year(date), month=month(date), day=day(date))%>%group_by(year,month)%>%summarize(sum=sum(item_cnt_day))%>%ungroup%>%select(sum) %>%ts(frequency = 12,start = 2013 )
ts_data <-train%>%mutate(year=year(date), month=month(date), day=day(date))%>%group_by(year,month)%>%summarize(sum=sum(item_cnt_day))%>%ungroup%>%select(sum) %>%ts(frequency = 12,start = 2013 )
str(ts_data)
head(ts_data)
train_month$date_block_num <- ts(train_month$date_block_num.groupby(train_month$date_block_num), frequency = 12,start = 0)
ddply(train_month,~group,summarise,date_block_num=ts(date_block_num, frequency = 12, start = 0))
import('ddply')
library(dplyr)
library(ddplyr)
install.packages('ddply')
library(ddplyr)
ddply(train_month,~group,summarise,date_block_num=ts(date_block_num, frequency = 12, start = 0))
library(xts)
library(dplyr)
df_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
mutate(ts = xts(date, order.by = as.Date(date)))
library(dplyr)
install.package('dplyr')
install.package('tidyverse')
install.package("tidyverse")
install.package("dyplr")
library(tidyverse)
library(lubridate)
df_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
summarize(item_cnt_month = sum(item_cnt_day))
rm(ts_data)
save.image("D:/Projects/kaggle/time_series/working_files.RData")
library(xts)
ts_train <- df_train %>% group_by(shop_id, item_id) %>%
mutate(ts = xts(date_block_num, order_by = train$date_block_num))
View(df_train)
subset(df_train, df_train$shop_id == 0 & df_train$item_id == 32)
subset(df_train, df_train$shop_id == 0 & df_train$item_id == 5)
subset(df_train, df_train$shop_id == 0 & df_train$item_id == 55)
subset(df_train, df_train$shop_id == 55 & df_train$item_id == 1)
View(categories)
View(items)
View(test)
View(test)
View(df_train)
View(train)
df_train <- train %>% group_by(date_block_num, shop_id, item_id, year, month) %>%
summarize(item_cnt_month = sum(item_cnt_day))
View(df_train)
df_train$date_block_num <- df_train$date_block_num + 1
View(df_train)
View(categories)
View(items)
regression <- df_train %>% lm(item_cnt_month ~ date_block_num, year, month, shop_id, item_id)
regression <- lm(df_train$item_cnt_month ~ df_train$date_block_num, df_train$year,
df_train$month, df_train$shop_id, df_train$item_id)
class(df_Train$date_block_num)
class(df_train$date_block_num)
class(df_train$year)
class(df_train$month)
class(df_train$shop_id)
class(df_train$item_id)
regression <- lm(item_cnt_month ~ df_train$date_block_num + df_train$year +
df_train$month, data = df_train)
View(regression)
rm(regression)
library(e1071)
<- install.packages('e1071')
install.packages('e1071')
library(e1071)
#itop value = item_id * shop_id and set as factor
df_train$itop <- df_train$shop_id * df_train$item_id
View(df_train)
#itop value = item_id * shop_id and set as factor
df_train$itop <- as.Factor('1000000' + df_train$shop_id + df_train$item_id)
#itop value = item_id * shop_id and set as factor
df_train$itop <-'1000000' + df_train$shop_id + df_train$item_id
#itop value = item_id * shop_id and set as factor
df_train$itop <-1000000 + df_train$shop_id + df_train$item_id
View(df_train)
#itop value = item_id * shop_id and set as factor
df_train$itop <-as.factor(1000000 + df_train$shop_id + df_train$item_id)
View(df_train)
class(df_train$itop)
bayes <- naiveBayes(item_cnt_month ~., data = df_train)
bayes <- naiveBayes(item_cnt_month ~., data = df_train)
```
class(bayes)
View(df_train)
summary(bayes)
print(bayes)
test$itop <- as.factor(1000000 + test$shop_id + test$item_id)
View(test)
preds <- predict(bayes, newdata = subset(test, select = -ID))
reg <- lm(item_cnt_month ~., data = df_train)
rm(bayes)
reg <- glm(item_cnt_month ~., data = df_train)
gc()
gc()
reg <- glm(item_cnt_month ~., data = df_train)
library(randomForest)
install.packages("randomForest")
library(randomForest)
forest <- randomForest(item_cnt_month ~., data = df_train)
df_train <- train %>% group_by(date_block_num, shop_id, item_id, year, month) %>%
summarize(item_cnt_month = sum(item_cnt_day))
ran_train <- df_train
ran_train$month <- as.factor(ran_train$month)
View(ran_train)
ran_train$date_block_num <- as.factor(ran_train$date_block_num)
forest <- randomForest(item_cnt_month ~., data = df_train)
gc()
class(df_train$shop_id)
df_train$shop_id = as.factor(df_train$shop_id)
df_train$item_id = as.factor(df_train$item_id)
ran_train <- df_train
ran_train$month <- as.factor(ran_train$month)
forest <- randomForest(item_cnt_month ~., data = df_train)
forest <- randomForest(item_cnt_month ~ year, month, data = df_train)
forest <- randomForest(item_cnt_month ~ year+ month, data = df_train)
save.image("D:/Projects/kaggle/time_series/working_files.RData")
basic <- df_train %>% group_by(shop_id, item_id) %>%
summarize(mean_count = mean(item_cnt_month))
library(tidyverse)
library(xts)
library(lubridate)
basic <- df_train %>% group_by(shop_id, item_id) %>%
summarize(mean_count = mean(item_cnt_month))
View(basic)
df_train <- train %>% group_by(date_block_num, shop_id, item_id, year, month) %>%
summarize(item_cnt_month = sum(item_cnt_day))
basic <- df_train %>% group_by(shop_id, item_id) %>%
summarize(mean_count = mean(item_cnt_month))
subset(df_train, df_train#shop_id == 0 & item_id == 30)
)
subset(df_train, df_train$shop_id == 0 & df_train$item_id == 30)
basic_test <- test %>% select(ID, shop_id, item_id)
View(basic_test)
overall_mean <- mean(basic$mean_count)
basic_test <- merge(x = basic_test, y = basic, by = c("shop_id", "item_id"), all.x = TRUE)
basic_test[is.na(mean_count)] <- overall_mean
basic_test[is.na(basic_test$mean_count)] <- overall_mean
basic_test$mean_count[is.na(basic_test$mean_count)] <- overall_mean
preds = basic_test$mean_count
sample_sub$item_cnt_month = preds
sample_sub.to_csv('basic_af_model.csv', index=False)
View(sample_sub)
sample_sub.to_csv('basic_af_model.csv', index=False)
sample_sub.to_csv('basic_af_model.csv', index=False)
write.csv(sample_sub, file = "D:\\projects\kaggle\time_series\basic_af.csv", row.names = FALSE)
write.csv(sample_sub, file = "D://projects/kaggle/time_series/basic_af.csv", row.names = FALSE)
overall_mean <- median(basic$mean_count)
overall_median <- median(basic$mean_count)
overall_median <- mean(basic$mean_count)
basic <- df_train %>% group_by(shop_id, item_id) %>%
summarize(mean_count = median(item_cnt_month))
View(basic)
basic_test <- test %>% select(ID, shop_id, item_id)
basic_test <- merge(x = basic_test, y = basic, by = c("shop_id", "item_id"), all.x = TRUE)
basic_test$mean_count[is.na(basic_test$mean_count)] <- overall_mean
preds = basic_test$mean_count
sample_sub$item_cnt_month = preds
View(sample_sub)
overall_mean <- mean(basic$mean_count)
basic_test <- test %>% select(ID, shop_id, item_id)
basic_test <- merge(x = basic_test, y = basic, by = c("shop_id", "item_id"), all.x = TRUE)
basic_test$mean_count[is.na(basic_test$mean_count)] <- overall_mean
preds = basic_test$mean_count
sample_sub$item_cnt_month = preds
write.csv(sample_sub, file = "D://projects/kaggle/time_series/basic_af.csv", row.names = FALSE)
View(basic_test)
basic_test <- test %>% select(ID, shop_id, item_id, month)
library(tidyverse)
library(xts)
library(lubridate)
basic_test <- test %>% select(ID, shop_id, item_id, month)
basic_test <- merge(x = basic_test, y = basic, by = c("shop_id", "item_id", 'month'), all.x = TRUE)
View(basic_test)
View(basic)
basic <- df_train %>% group_by(shop_id, item_id, month) %>%
summarize(mean_count = median(item_cnt_month))
basic_test <- merge(x = basic_test, y = basic, by = c("shop_id", "item_id", 'month'), all.x = TRUE)
basic_test <- test %>% select(ID, shop_id, item_id, month)
basic_test <- merge(x = basic_test, y = basic, by = c("shop_id", "item_id", 'month'), all.x = TRUE)
basic_test$mean_count[is.na(basic_test$mean_count)] <- overall_mean
View(basic_test)
item_mean <- df_train %>% group_by(item_id, month) %>%
summarize(mean_count = median(item_cnt_month))
basic_test <- merge(x = basic_test, y = item_mean, by = c("item_id", 'month'), all.x = TRUE)
View(basic_test)
basic <- df_train %>% group_by(item_id, month) %>%
summarize(mean_count = median(item_cnt_month))
basic_test <- test %>% select(ID, shop_id, item_id, month)
basic_test <- merge(x = basic_test, y = basic, by = c("item_id", 'month'), all.x = TRUE)
basic_test$mean_count[is.na(basic_test$mean_count)] <- overall_mean
View(basic_test)
preds = basic_test$mean_count
sample_sub$item_cnt_month = preds
preds = basic_test$mean_count
sample_sub$item_cnt_month = preds
write.csv(sample_sub, file = "D://projects/kaggle/time_series/basic_af_2.csv", row.names = FALSE)
View(test)
ts_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
summarize(item_cnt_month = sum(item_cnt_day))
library(tidyverse)
library(xts)
library(lubridate)
ts_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
summarize(item_cnt_month = sum(item_cnt_day))
View(ts_train)
airpassangers
airPassangers
AirPassangers
AirPassengers
ts_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
mutate(item_cnt_month = ts(sum(item_cnt_day), start = 0, end = 33, frequency = 12))
ts_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
mutate(item_cnt_month = xts(sum(item_cnt_day), order.by = as.Date(date)))
ts_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
summarize(item_cnt_month = SUM(item_cnt_day)) %>%
mutate(ts = xts(item_cnt_month, order.by = as.Date(date)))
ts_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
summarize(item_cnt_month = sum(item_cnt_day)) %>%
mutate(ts = xts(item_cnt_month, order.by = as.Date(date)))
ts_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
summarize(item_cnt_month = sum(item_cnt_day)) %>%
mutate(ts = xts(item_cnt_month, order.by = date_block_num))
View(train)
ts_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
summarize(item_cnt_month = sum(item_cnt_day)) %>%
mutate(ts = xts(item_cnt_month, order.by = as.Date(train$date)))
View(train)
ts_train <- train %>% group_by(date_block_num, shop_id, item_id, date) %>%
summarize(item_cnt_month = sum(item_cnt_day)) %>%
mutate(ts = xts(item_cnt_month, order.by = as.Date(ts_train$date)))
ts_train <- train %>% group_by(date_block_num, shop_id, item_id, date) %>%
summarize(item_cnt_month = sum(item_cnt_day))# %>%
#  mutate(ts = xts(item_cnt_month, order.by = as.Date(ts_train$date)))
ts_test <- subset(ts_train, ts_train$shop_id = 0 & item_id = 30)
ts_test <- subset(ts_train, ts_train$shop_id == 0 & item_id == 30)
View(ts_test)
ts_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
summarize(item_cnt_month = sum(item_cnt_day))# %>%
ts_test <- subset(ts_train, ts_train$shop_id == 0 & item_id == 30)
View(ts_test)
ts_test <- subset(ts_train, ts_train$shop_id == 0 & item_id == 50)
ts_test <- subset(ts_train, ts_train$shop_id == 0 & item_id == 52)
View(train)
ts_test <- subset(ts_train, ts_train$shop_id == 0)
ts_test <- subset(ts_train, ts_train$shop_id == 1871)
ts_test <- subset(ts_train, ts_train$shop_id == 0, & item_id == 1871)
ts_test <- subset(ts_train, ts_train$shop_id == 0 & item_id == 1871)
ts_test <- subset(ts_train, ts_train$shop_id == 0 & ts_train$item_id == 1871)
View(ts_train)
View(ts_train)
View(ts_test)
ts_test <- subset(ts_train, ts_train$item_id == 1871)
ts_test <- subset(ts_train, ts_train$shop_id == 10 & ts_train$item_id == 1871)
ts_test = ts(ts_test$item_cnt_month, start = 0, end = 33, frequency = 12)
ts_test
ts_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
summarize(item_cnt_month = sum(item_cnt_day), date = date)# %>%
ts_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
select(date) %>%
summarize(item_cnt_month = sum(item_cnt_day))# %>%
ts_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
summarize(item_cnt_month = sum(item_cnt_day)) %>%
select(date)# %>%
ts_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
summarize(item_cnt_month = sum(item_cnt_day), date = floor_date(date))# %>%
ts_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
summarize(item_cnt_month = sum(item_cnt_day), date = mode(floor_date(date)))# %>%
View(ts_train)
ts_test <- subset(ts_train, ts_train$shop_id == 10 & ts_train$item_id == 1871)
View(ts_test)
### TRIAL HERE
ts <- rnorm(34, m = 0, sd = 0)
View(ts_test)
for (i in ts_test$date_block_num){
ts[i] = ts_test[ts_test$date_block_num == i]$item_cnt_month
}
summarize(item_cnt_month = sum(item_cnt_day))# %>%
ts_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
summarize(item_cnt_month = sum(item_cnt_day))# %>%
ts_test <- subset(ts_train, ts_train$shop_id == 10 & ts_train$item_id == 1871)
View(ts_test)
ts[2]
for (i in ts_test$date_block_num){
ts[i] <- ts_test[ts_test$date_block_num == i]$item_cnt_month
}
for (i in ts_test$date_block_num){
ts[i] <- ts_test[which(ts_test$date_block_num == i),3]
}
View(ts)
ts
for (i in ts_test$date_block_num){
ts[i] <- ts_test[which(ts_test$date_block_num == i),4]
}
View(ts)
ts
ts <- ts(ts, start = 0, end = 33, frequency = 1)
ts
ts <- ts(ts, start = 0, end = 33, frequency = 12)
ts
ts_test <- subset(ts_train, ts_train$shop_id == 10 & ts_train$item_id == 1871)
ts <- rnorm(34, m = 0, sd = 0)
for (i in ts_test$date_block_num){
ts[i] <- ts_test[which(ts_test$date_block_num == i),4]
}
ts <- ts(ts, start = 0, end = 33, frequency = 12)
ts
ts <- ts(ts, start = 0, end = 3, frequency = 12)
ts
ts <- ts(ts, start = 0, end = 33, frequency = 1)
ts_test <- subset(ts_train, ts_train$shop_id == 10 & ts_train$item_id == 1871)
ts <- rnorm(34, m = 0, sd = 0)
for (i in ts_test$date_block_num){
ts[i] <- ts_test[which(ts_test$date_block_num == i),4]
}
ts <- ts(ts, start = 0, end = 33, frequency = 1)
class(ts)
ts
plot(ts)
plot(ts_test)
plot(ts)
abline(reg = lm(ts~time(ts)))
plot(ts)
abline(reg = lm(ts~time(ts)))
time(ts)
abline(reg = lm(ts~time(ts)))
ap = AirPassengers
ts <- as.ts(ts, start = 0, end = 33, frequency = 1)
View(ts)
ts <- rnorm(34, m = 0, sd = 0)
ts <- ts(ts, start = 0, end = 33, frequency = 1)
for (i in ts_test$date_block_num){
replace(ts,i,ts_test[which(ts_test$date_block_num == i),4])
}
ts
for (i in ts_test$date_block_num){
ts[i] <- ts_test[which(ts_test$date_block_num == i),4]
}
ts <- rnorm(34, m = 0, sd = 0)
ts <- ts(ts, start = 0, end = 33, frequency = 1)
ts[2]
ts[0] <- 1
ts
ts[1] <- 1
ts
View(train)
View(ts_test)
for (i in ts_test$date_block_num){
ts[i+1] <- ts_test[which(ts_test$date_block_num == i),4]
}
ts <- rnorm(34, m = 0, sd = 0)
ts <- ts(ts, start = 0, end = 33, frequency = 1)
ts_test[which(ts_test$date_block_num == 1),4].value
ts_test[which(ts_test$date_block_num == 1),4]
for (i in ts_test$date_block_num){
ts[i+1] <- ts_test[ts_test$date_block_num == i,4]
}
View(ts_test)
View(ts)
ts
ts <- rnorm(34, m = 0, sd = 0)
ts <- ts(ts, start = 0, end = 33, frequency = 1)
for (i in ts_test$date_block_num){
ts[i+1] <-4
}
ts
ts_test <- subset(ts_train, ts_train$shop_id == 10 & ts_train$item_id == 1871)
ts <- rnorm(34, m = 0, sd = 0)
ts <- ts(ts, start = 0, end = 33, frequency = 1)
for (i in 1:33){
if(exists(i, where=ts_test)){
j = ts_test[which(ts_test$date_block_num == i), 1]
ts[i] <- ts_test[j,4]
}
}
ts_test <- subset(ts_train, ts_train$shop_id == 10 & ts_train$item_id == 1871)
ts <- rnorm(34, m = 0, sd = 0)
ts <- ts(ts, start = 0, end = 33, frequency = 1)
for (i in 1:33){
if(is.element(i,ts_test)){
j = ts_test[which(ts_test$date_block_num == i), 1]
ts[i] <- ts_test[j,4]
}
}
ts
ts_test[which(ts_test$date_block_num == 1), 1]
for (i in 1:33){
if(is.element(i,ts_test)){
j <- ts_test[which(ts_test$date_block_num == i), 1]
ts[i] <- ts_test[j,4]
}
}
ts
for (i in 1:33){
print(i)
if(is.element(i,ts_test)){
j <- ts_test[which(ts_test$date_block_num == i), 1]
ts[i] <- ts_test[j,4]
}
}
for (i in 1:33){
if(is.element(i,ts_test)){
j <- ts_test[which(ts_test$date_block_num == i), 1]
print(j)
ts[i] <- ts_test[j,4]
}
}
for (i in 1:33){
if(is.element(i,ts_test$date_block_num)){
j <- ts_test[which(ts_test$date_block_num == i), 1]
ts[i] <- ts_test[j,4]
}
}
for (i in 1:33){
if(i %in% ts_test$date_block_num){
j <- ts_test[which(ts_test$date_block_num == i), 1]
ts[i] <- ts_test[j,4]
}
}
View(ts_test)
for (i in 1:33){
if(i %in% ts_test$date_block_num){
j <- ts_test[which(ts_test$date_block_num == i), 1]
ts[i] <- ts_test[j,4]
}
}
1 %in% ts_test$date_block_num
for (i in 1:33){
if(i %in% ts_test$date_block_num){
j <- which(ts_test$date_block_num == i)
ts[i] <- ts_test[j,4]
}
}
ts_test <- subset(ts_train, ts_train$shop_id == 10 & ts_train$item_id == 1871)
ts <- rnorm(34, m = 0, sd = 0)
ts <- ts(ts, start = 0, end = 33, frequency = 1)
for (i in 1:33){
if(i %in% ts_test$date_block_num){
j <- which(ts_test$date_block_num == i)
ts[i] <- ts_test[j,4]
}
}
View(ts)
ts
View(ts_test)
ts[34] ,_ ts_test[1,4]
ts[33] ,_ ts_test[1,4]
ts[34] <- ts_test[1,4]
ts
ts_test <- subset(ts_train, ts_train$shop_id == 10 & ts_train$item_id == 1871)
ts <- rnorm(34, m = 0, sd = 0)
ts <- ts(ts, start = 0, end = 33, frequency = 1)
ts[34] <- ts_test[1,4]
ts_test <- subset(ts_train, ts_train$shop_id == 10 & ts_train$item_id == 1871)
ts <- rnorm(34, m = 0, sd = 0)
ts <- ts(ts, start = 0, end = 33, frequency = 1)
ts[34] <- 4
num <- ts_test[1,4]
class(num)
num <- as.numeric(num)
ts_test <- subset(ts_train, ts_train$shop_id == 10 & ts_train$item_id == 1871)
ts <- rnorm(34, m = 0, sd = 0)
ts <- ts(ts, start = 0, end = 33, frequency = 1)
for (i in 1:33){
if(i %in% ts_test$date_block_num){
j <- which(ts_test$date_block_num == i)
num <- ts_test[j,4]
ts[i] <- as.numeric(num)
}
}
ts
plot(ts)
abline(reg = lm(ts~time(ts)))
rm(ran_train)
rm(train_month)
save.image("D:/Projects/kaggle/time_series/working_files.RData")
