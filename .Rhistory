knitr::opts_chunk$set(echo = TRUE)
#train data
train <- read.csv('../data/train.csv')
#train data
train <- read.csv('..\data\train.csv')
#train data
train <- read.csv('data/train.csv')
test <- read.csv('data/test.csv')
train <- read.csv('data/sample_submission.csv')
#additional data included
items <- read.csv('data/items.csv')
categories <- read.csv('data/item_categories.csv')
shops <- read.csv("data/shops.csv")
dim(train)
Dim(test)
dim(test)
print("train", dim(train))
print("train") dim(train
print("train")
dim(train)
dim(train)
dim(test)
View(test)
View(test)
View(train)
View(train)
train <- read.csv('data/train.csv')
#test data & Kaggle sample sub
test <- read.csv('data/test.csv')
sample_sub <- read.csv('data/sample_submission.csv')
#additional data included
items <- read.csv('data/items.csv')
categories <- read.csv('data/item_categories.csv')
shops <- read.csv("data/shops.csv")
dim(train)
dim(test)
View(train)
View(train)
View(test)
View(test)
head(train)
dim(train)
head(train)
dim(test)
head(test)
View(sample_sub)
dim(train)
head(train)
dim(test)
head(test)
head(sample_sub)
train$item_cnt_month <- aggregate(train$item_cnt_day,
by=list(train$date_block_num, train$shop_id, train$item_id),
FUN=sum, na.rm=TRUE)
train$item_cnt_month <- aggregate(train$item_cnt_day,
by=group(train$date_block_num, train$shop_id, train$item_id),
FUN=sum)
#First set year variables
train$year <- substr(train$date, nchar(4)-n+1)
#First set year variables
train$year <- substr(train$date, -4)
train$year <- substr(train$date, -4, -1)
#First set year variables
train$year <- substr(train$date, 6, 9)
View(train)
#First set year variables
train$year <- substr(train$date, 7, 10)
sapply(train, class)
train$year <- as.numeric(train$year)
sapply(train, class)
train$date <- as.Date(train$date, "%d/%m/%Y")
sapply(train, class)
#train data
train <- read.csv('data/train.csv')
#test data & Kaggle sample sub
test <- read.csv('data/test.csv')
sample_sub <- read.csv('data/sample_submission.csv')
#additional data included
items <- read.csv('data/items.csv')
categories <- read.csv('data/item_categories.csv')
shops <- read.csv("data/shops.csv")
train$year <- substr(train$date, 7, 10)
train$year <- as.numeric(train$year)
train$date <- as.Date(train$date)
train$date <- as.Date(train$date, "%d/%m/%Y")
train$date[0]
Sys.setlocale("LC_TIME", lct)
Sys.getlocale("LC_TIME")
Sys.setlocale("LC_TIME", "C")
Sys.setlocale("LC_TIME", "C")
train <- read.csv('data/train.csv')
#test data & Kaggle sample sub
test <- read.csv('data/test.csv')
sample_sub <- read.csv('data/sample_submission.csv')
#additional data included
items <- read.csv('data/items.csv')
categories <- read.csv('data/item_categories.csv')
shops <- read.csv("data/shops.csv")
train <- read.csv('data/train.csv'stringsAsFactors = FALSE)
train <- read.csv('data/train.csv', stringsAsFactors = FALSE)
train$year <- substr(train$date, 7, 10)
train$year <- as.numeric(train$year)
train$date <- as.Date(train$date, "%d/%m/%Y")
train <- read.csv('data/train.csv', stringsAsFactors = FALSE)
#test data & Kaggle sample sub
test <- read.csv('data/test.csv')
sample_sub <- read.csv('data/sample_submission.csv')
#additional data included
items <- read.csv('data/items.csv')
categories <- read.csv('data/item_categories.csv')
shops <- read.csv("data/shops.csv")
train$year <- substr(train$date, 7, 10)
train$year <- as.numeric(train$year)
train$date <- as.Date(train$date, "%d.%m.%Y")
sapply(train, class)
train$item_cnt_month <- aggregate(item_cnt_day ~ date_block_num + shop_id + item_id,
data = train, FUN=sum)
train$item_cnt_month <- aggregate(item_cnt_day ~ year + date_block_num + shop_id + item_id,
data = train, FUN=sum)
train$item_cnt_month <- sum(item_cnt_day ~ year + date_block_num + + shop_id + item_id)
train$item_cnt_month <- lapply(train, sum(item_cnt_day ~ year + date_block_num + + shop_id + item_id))
train$item_cnt_month <- tapply(item_cnt_day ~ year + date_block_num + + shop_id + item_id,
data = train, FUN=sum)
train$item_cnt_month <- tapply(train$item_cnt_day,  train$year + train$date_block_num + train$shop_id + train$item_id,
FUN=sum)
train$item_cnt_month <- aggregate(item_cnt_day ~ year + date_block_num + + shop_id + item_id,
data = train, FUN=sum)
item_cnt_month <- aggregate(item_cnt_day ~ year + date_block_num + + shop_id + item_id,
data = train, FUN=sum)
View(item_cnt_month)
View(items)
train <- read.csv('data/train.csv', stringsAsFactors = FALSE)
#test data & Kaggle sample sub
test <- read.csv('data/test.csv')
sample_sub <- read.csv('data/sample_submission.csv')
#additional data included
items <- read.csv('data/items.csv')
categories <- read.csv('data/item_categories.csv')
shops <- read.csv("data/shops.csv")
```{r explore}
dim(train)
head(train)
dim(test)
head(test)
head(sample_sub)
train$year <- substr(train$date, 7, 10)
train$year <- as.numeric(train$year)
train$month <- substr(train$date, 4, 5)
train$month <- as.numeric(train$year)
train$month <- substr(train$date, 4, 5)
train$month <- as.numeric(train$month)
train$date <- as.Date(train$date, "%d.%m.%Y")
sapply(train, class)
item_cnt_month <- aggregate(item_cnt_day ~ year + month + date_block_num + shop_id + item_id +
price, data = train, FUN=sum)
item_cnt_month <- aggregate(item_cnt_day ~ year + month + date_block_num + shop_id + item_id +
item_price, data = train, FUN=sum)
View(item_cnt_month)
train_month <- aggregate(item_cnt_day ~ year + month + date_block_num + shop_id + item_id,
data = train, FUN=sum)
names(train_month)[names(train_month) == 'item_cnt_day'] <- 'item_cnt_month'
drop(item_cnt_month)
remove(item_cnt_month)
View(train_month)
sapply(train, function(x) sum(is.na(x)))
nrow(train)
train_month <- cbind(train_month, apply(train_month,1, 34))
for (i in 1:nrow(train_month)){
train_month[1,7] = 34
}
View(train_month)
for (i in 1:nrow(train_month)){
train_month[i,7] = 34
}
train <- read.csv('data/train.csv', stringsAsFactors = FALSE)
#test data & Kaggle sample sub
test <- read.csv('data/test.csv')
sample_sub <- read.csv('data/sample_submission.csv')
#additional data included
items <- read.csv('data/items.csv')
categories <- read.csv('data/item_categories.csv')
shops <- read.csv("data/shops.csv")
train$year <- substr(train$date, 7, 10)
train$year <- as.numeric(train$year)
train$month <- substr(train$date, 4, 5)
train$month <- as.numeric(train$month)
train$date <- as.Date(train$date, "%d.%m.%Y")
sapply(train, class)
train_month <- aggregate(item_cnt_day ~ year + month + date_block_num + shop_id + item_id,
data = train, FUN=sum)
names(train_month)[names(train_month) == 'item_cnt_day'] <- 'item_cnt_month'
for (i in 1:nrow(test)){
test[i,4] = 34
}
names(train_month)[names(train_month) == 'V4'] <- 'date_block_num'
View(test)
names(train_month)[4] <- 'date_block_num'
colnames(train_month)[4] <- c('date_block_num')
colnames(test)[4] <- c('date_block_num')
train_month <- aggregate(item_cnt_day ~ year + month + date_block_num + shop_id + item_id,
data = train, FUN=sum)
names(train_month)[names(train_month) == 'item_cnt_day'] <- 'item_cnt_month'
for (i in 1:nrow(test)){
test[i,4] = 34
test[i, 5] = 2015
test[i, 6] = 11
}
colnames(test)[4:6] <- c('date_block_num', 'year', 'month')
save.image("D:/Projects/kaggle/time_series/working_files.RData")
View(train)
View(train)
knitr::opts_chunk$set(echo = TRUE)
train_month <- as.ts(train_month$date_block_num)
load("D:/Projects/kaggle/time_series/working_files.RData")
train_month$date_block_num <- as.ts(train_month$date_block_num)
sum(train_month$date_block_num)
dim(train_month$date_block_num)
summary(train_month$date_block_num)
type(train_month$date_block_num)
print ts(train_month$date_block_num)
print.ts(train_month$date_block_num)
head(train_month$date_block_num)
train_month$date_block_num.getElementType()
sapply(train_month, class)
sapply(train_month, class)
seasonal_fit <- stl(train_month, s.window="period")
seasonal_fit <- stl(train_month$date_block_num, s.window="period")
train_month$date_block_num <- ts(train_month$date_block_num, start = 0, end = 33, frequency = 12)
load("D:/Projects/kaggle/time_series/working_files.RData")
train_month$date_block_num <- ts(train_month$date_block_num, start = 0, end = 33, frequency = 12)
train_month$date_block_num <- as.ts(train_month$date_block_num, start = 0, end = 33, frequency = 12)
sapply(train_month, class)
seasonal_fit <- stl(train_month$date_block_num, s.window="period")
seasonal_fit <- stl(train_month$date_block_num, s.window=12)
str(train_monthly$date_block_num)
str(train_month$date_block_num)
install.packages('hts')
install.packages('zoo')
load("D:/Projects/kaggle/time_series/working_files.RData")
str(train_month)
str(train)
ts_data <-train_month%>%mutate(year=year(date), month=month(date), day=day(date))%>%group_by(year,month)%>%summarize(sum=sum(item_cnt_day))%>%ungroup%>%select(sum) %>%ts(frequency = 12,start = 2013 )
library(DataCombine)
install.packages('dataCombine')
y
install.packages('DataCombine')
library(DataCombine)
ts_data <-train_month%>%mutate(year=year(date), month=month(date), day=day(date))%>%group_by(year,month)%>%summarize(sum=sum(item_cnt_day))%>%ungroup%>%select(sum) %>%ts(frequency = 12,start = 2013 )
knitr::opts_chunk$set(echo = TRUE)
ts_data = df()
ts_data = data.table
ts_data = data.table()
library(lubridate)
install.packages('lubridate')
library(lubridate)
ts_data <-train_month%>%mutate(year=year(date), month=month(date), day=day(date))%>%group_by(year,month)%>%summarize(sum=sum(item_cnt_day))%>%ungroup%>%select(sum) %>%ts(frequency = 12,start = 2013 )
library(forecast)
library(DataCombine)
library(ggplot2) # Data visualization
library(readr) # CSV file I/O, e.g. the read_csv function
install.packages('readr')
install.packages('forecast')
install.packages("forecast")
library(forecast)
library(DataCombine)
library(ggplot2) # Data visualization
library(readr) # CSV file I/O, e.g. the read_csv function
library (data.table)
library(lubridate)
library(dplyr)
library(tseries)
ts_data <-train_month%>%mutate(year=year(date), month=month(date), day=day(date))%>%group_by(year,month)%>%summarize(sum=sum(item_cnt_day))%>%ungroup%>%select(sum) %>%ts(frequency = 12,start = 2013 )
ts_data <-train%>%mutate(year=year(date), month=month(date), day=day(date))%>%group_by(year,month)%>%summarize(sum=sum(item_cnt_day))%>%ungroup%>%select(sum) %>%ts(frequency = 12,start = 2013 )
str(ts_data)
head(ts_data)
train_month$date_block_num <- ts(train_month$date_block_num.groupby(train_month$date_block_num), frequency = 12,start = 0)
ddply(train_month,~group,summarise,date_block_num=ts(date_block_num, frequency = 12, start = 0))
import('ddply')
library(dplyr)
library(ddplyr)
install.packages('ddply')
library(ddplyr)
ddply(train_month,~group,summarise,date_block_num=ts(date_block_num, frequency = 12, start = 0))
library(xts)
library(dplyr)
df_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
mutate(ts = xts(date, order.by = as.Date(date)))
library(dplyr)
install.package('dplyr')
install.package('tidyverse')
install.package("tidyverse")
install.package("dyplr")
library(tidyverse)
library(lubridate)
df_train <- train %>% group_by(date_block_num, shop_id, item_id) %>%
summarize(item_cnt_month = sum(item_cnt_day))
rm(ts_data)
save.image("D:/Projects/kaggle/time_series/working_files.RData")
library(xts)
ts_train <- df_train %>% group_by(shop_id, item_id) %>%
mutate(ts = xts(date_block_num, order_by = train$date_block_num))
View(df_train)
subset(df_train, df_train$shop_id == 0 & df_train$item_id == 32)
subset(df_train, df_train$shop_id == 0 & df_train$item_id == 5)
subset(df_train, df_train$shop_id == 0 & df_train$item_id == 55)
subset(df_train, df_train$shop_id == 55 & df_train$item_id == 1)
View(categories)
View(items)
View(test)
View(test)
View(df_train)
View(train)
df_train <- train %>% group_by(date_block_num, shop_id, item_id, year, month) %>%
summarize(item_cnt_month = sum(item_cnt_day))
View(df_train)
df_train$date_block_num <- df_train$date_block_num + 1
View(df_train)
View(categories)
View(items)
regression <- df_train %>% lm(item_cnt_month ~ date_block_num, year, month, shop_id, item_id)
regression <- lm(df_train$item_cnt_month ~ df_train$date_block_num, df_train$year,
df_train$month, df_train$shop_id, df_train$item_id)
class(df_Train$date_block_num)
class(df_train$date_block_num)
class(df_train$year)
class(df_train$month)
class(df_train$shop_id)
class(df_train$item_id)
regression <- lm(item_cnt_month ~ df_train$date_block_num + df_train$year +
df_train$month, data = df_train)
View(regression)
rm(regression)
library(e1071)
<- install.packages('e1071')
install.packages('e1071')
library(e1071)
#itop value = item_id * shop_id and set as factor
df_train$itop <- df_train$shop_id * df_train$item_id
View(df_train)
#itop value = item_id * shop_id and set as factor
df_train$itop <- as.Factor('1000000' + df_train$shop_id + df_train$item_id)
#itop value = item_id * shop_id and set as factor
df_train$itop <-'1000000' + df_train$shop_id + df_train$item_id
#itop value = item_id * shop_id and set as factor
df_train$itop <-1000000 + df_train$shop_id + df_train$item_id
View(df_train)
#itop value = item_id * shop_id and set as factor
df_train$itop <-as.factor(1000000 + df_train$shop_id + df_train$item_id)
View(df_train)
class(df_train$itop)
bayes <- naiveBayes(item_cnt_month ~., data = df_train)
bayes <- naiveBayes(item_cnt_month ~., data = df_train)
```
class(bayes)
View(df_train)
summary(bayes)
print(bayes)
test$itop <- as.factor(1000000 + test$shop_id + test$item_id)
View(test)
preds <- predict(bayes, newdata = subset(test, select = -ID))
reg <- lm(item_cnt_month ~., data = df_train)
rm(bayes)
reg <- glm(item_cnt_month ~., data = df_train)
gc()
gc()
reg <- glm(item_cnt_month ~., data = df_train)
library(randomForest)
install.packages("randomForest")
library(randomForest)
forest <- randomForest(item_cnt_month ~., data = df_train)
df_train <- train %>% group_by(date_block_num, shop_id, item_id, year, month) %>%
summarize(item_cnt_month = sum(item_cnt_day))
ran_train <- df_train
ran_train$month <- as.factor(ran_train$month)
View(ran_train)
ran_train$date_block_num <- as.factor(ran_train$date_block_num)
forest <- randomForest(item_cnt_month ~., data = df_train)
gc()
class(df_train$shop_id)
df_train$shop_id = as.factor(df_train$shop_id)
df_train$item_id = as.factor(df_train$item_id)
ran_train <- df_train
ran_train$month <- as.factor(ran_train$month)
forest <- randomForest(item_cnt_month ~., data = df_train)
forest <- randomForest(item_cnt_month ~ year, month, data = df_train)
forest <- randomForest(item_cnt_month ~ year+ month, data = df_train)
save.image("D:/Projects/kaggle/time_series/working_files.RData")
